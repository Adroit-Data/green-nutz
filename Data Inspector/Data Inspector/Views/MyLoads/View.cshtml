@model  System.Data.DataTable

@using System.Data;

@{
    ViewBag.Title = "View";

}

@section scripts{
    <script src="~/Scripts/tableloaddata.js"></script>
    <script>
        var tableid = window.location.href.substr(window.location.href.lastIndexOf('/') + 1);
        TableLoadApp.value("tableid", tableid);                
    </script>
}

<h2>View</h2>

<div ng-app="TableLoadApp" class="container">
    <input type="text" placeholder="Search Data" ng-model="searchData" />
    <br />
    <div ng-controller="TableLoadController">
        <table class="table table-striped table-condensed table-hover">
            <tr>
                <th ng-repeat="header in headers">
                    {{headers[$index]}} <a ng-click="sortData($index)"><i class="fas fa-sort"></i></a>
                </th>              
                <th>
                    <button ng-click="reload()">Unsort</button>
                </th>
            </tr>
            <tr ng-repeat="r in tableload.data | orderBy : sortColumn : reverseSort | filter : searchData" ng-include="getTemplate(r)">
            </tr>            
        </table>
        <script type="text/ng-template" id="display">
            @foreach (DataColumn col in Model.Columns)
            {
                string jsCol = "{{r." + col.ColumnName + "}}";
                if (col.ColumnName != "DIRowID")
                {                    
                    <td>@jsCol</td>
                }
                else
                {                   
                    <td style="display: none">@jsCol</td>
                }
            }
            <td>
                <button ng-click="editData(r)">Edit</button>
            </td>
        </script>
        <script type="text/ng-template" id="edit">
            @foreach (DataColumn col in Model.Columns)
            {
                if (col.ColumnName != "DIRowID")
                {
                    <td><input type="text" ng-model="tableload.selected.@col.ColumnName" /></td>
                }
            }
            <td>
                <button ng-click="saveData($index,r,tableload.selected)">Save</button>
                <button ng-click="reset()">Cancel</button>
            </td>
        </script>
    </div>
</div>





